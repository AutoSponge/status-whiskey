<link rel="import" href="components/polymer/polymer.html">
<link rel="import" href="components/core-ajax/core-ajax.html">
<link rel="import" href="components/core-header-panel/core-header-panel.html">
<link rel="import" href="components/core-toolbar/core-toolbar.html">
<link rel="import" href="components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="components/pvc-spinner/pvc-spinner.html">

<link href='http://fonts.googleapis.com/css?family=Droid+Serif' rel='stylesheet' type='text/css'>

<polymer-element name="status-whiskey">

    <template>
        <style>
            #content {
                font-family: 'Droid Serif', serif;
            }
            core-header-panel {
                height: 100%;
            }
            .http-status {
                color: white;
                background-color: black;
                padding: 20px;
                margin: 20px;
                width: 300px;
                height: 350px;
            }
            .http-status img {
                width: 300px;
                height: 230px;
            }
        </style>

        <!-- fetch data! -->
        <core-ajax
                auto
                url="objects.json"
                handleAs="json"
                response="{{ response }}"
                on-core-response="{{ handleResponse }}"></core-ajax>

        <!-- start the app section -->
        <core-header-panel>
            <core-toolbar>
                <span flex>Whiskey Status Codes</span>
                <paper-icon-button
                        icon="social:post-github"
                        on-tap="{{ openRepo }}"></paper-icon-button>
            </core-toolbar>

            <!-- the app's main content area -->
            <div id="content" flex relative>
                <div hidden?="{{ showLoader }}" horizontal layout wrap>
                    <template repeat="{{ code in response.codes }}">
                        <template if="{{ code.img }}">
                            <div class="http-status" vertical layout>
                                <div horizontal center-justified layout>
                                    <a href="{{ code.img }}">
                                        <img alt="{{ code.code + ' ' + code.label }}" src="{{ code.img }}"/>
                                    </a>
                                </div>
                                <div horizontal center-justified layout>
                                    <h3>{{ code.code }}</h3>
                                </div>
                                <div horizontal center-justified layout>
                                    <h4>{{ code.label }}</h4>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>

                <div hidden?="{{ !showLoader }}">
                    <pvc-spinner type="fading-circle"></pvc-spinner>
                </div>

            </div>
        </core-header-panel>
    </template>

    <script>

        Polymer( 'status-whiskey', {
            codes: [],
            showLoader: true,
            handleResponse: function () {
                this.showLoader = false;
            },
            openRepo: function () {
                window.open( 'https://github.com/AutoSponge/status-whiskey', '_blank' );
            }
        } );

    </script>

</polymer-element>